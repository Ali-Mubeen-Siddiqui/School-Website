{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gallery</title>
<script src="https://unpkg.com/htmx.org@1.9.10"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
    :root {
        --bg-main: #181920;
        --bg-card: #23252e;
        --border: #313342;
        --accent: #536dfe;
        --primary: #2d3436;
        --accent2: #00b894;
        --font-main: #f5f6fa;
        --font-muted: #adb5bd;
        --album-shadow: 0 4px 16px rgba(0,0,0,0.45);
        --rounded: 12px;
    }
    html, body {
        height: 100%;
    }
    body {
        font-family: 'Segoe UI', Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: var(--bg-main);
        color: var(--font-main);
        min-height: 100vh;
        letter-spacing: 0.01em;
        /* subtle pixellate bg effect */
        background-image:
            repeating-linear-gradient(135deg, #23252e 0px, #23252e 2px, transparent 3px, transparent 6px),
            repeating-linear-gradient(225deg, #23252e 0px, #23252e 2px, transparent 3px, transparent 6px)
        ;
    }
    .gallery-header {
        background: linear-gradient(90deg, #23252e 80%, #313342 100%);
        color: var(--font-main);
        text-align: center;
        padding: 34px 10px 22px 10px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.20);
        position: relative;
    }
    .gallery-header h1 {
        margin: 0 0 0.4em 0;
        font-size: 2.2em;
        letter-spacing: 0.05em;
        font-weight: bold;
        background: linear-gradient(90deg,#536dfe 20%,#00b894 80%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-fill-color: transparent;
        display: inline-block;
    }
    .gallery-header p {
        margin: 0;
        color: var(--font-muted);
        font-size: 1.15em;
        letter-spacing: 0.03em;
    }

    .albums {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 18px;
        margin: 34px auto 20px auto;
        max-width: 900px;
    }
    .album {
        background: var(--bg-card);
        border: 1.5px solid var(--border);
        color: var(--font-main);
        min-width: 180px;
        max-width: 240px;
        min-height: 90px;
        box-shadow: var(--album-shadow);
        border-radius: var(--rounded);
        padding: 18px 26px;
        cursor: pointer;
        transition: background 0.18s, color 0.14s, transform 0.23s cubic-bezier(.16,1.2,.73,.95);
        display: flex;
        align-items: center;
        font-size: 1.11em;
        font-weight: 500;
        position: relative;
        overflow: hidden;
    }
    .album:hover, .album:focus, .album.active {
        background: linear-gradient(102deg, var(--primary) 60%, var(--accent) 130%);
        color: #fff;
        border-color: var(--accent2);
        box-shadow: 0 8px 32px rgba(0, 184, 148, 0.10), var(--album-shadow);
        transform: translateY(-3px) scale(1.03);
        outline: none;
    }
    .album strong {
        z-index: 2;
        font-weight: 600;
        text-shadow: 0 2px 8px rgba(0,0,0,0.08);
        flex: 1 1 auto;
    }
    .album::after {
        content: "\f07b";
        font: 900 2.1em "Font Awesome 6 Free";
        position: absolute;
        right: 22px;
        top: 50%;
        transform: translateY(-50%) scale(1.05);
        color: var(--accent2);
        opacity: 0.08;
        pointer-events: none;
        transition: color 0.3s;
    }
    .album:hover::after,
    .album.active::after {
        color: var(--font-main);
        opacity: 0.2;
    }
    .albums p {
        color: var(--font-muted);
        font-style: italic;
        font-size: 1.05em;
        flex-basis: 100%;
    }

    #media-grid {
        margin: 36px auto 34px auto;
        max-width: 1040px;
        display: flex;
        flex-wrap: wrap;
        gap: 17px;
        justify-content: center;
        border-radius: var(--rounded);
        min-height: 140px;
        background: rgba(35,37,46,0.35);
        box-shadow: var(--album-shadow);
        padding-bottom: 12px;
    }

    @media (max-width: 520px) {
        .albums {
            gap: 10px;
            margin: 21px auto 10px auto;
        }
        .album {
            font-size: 1em;
            min-width: 120px;
            max-width: 96vw;
            padding: 12px 10px;
        }
        .gallery-header {
            padding: 18px 3vw 16px 3vw;
        }
        #media-grid {
            margin: 12px 3vw 20px 3vw;
        }
    }
</style>
<script>
// Optional: visually mark the selected tab (client-side only)
// HTMX events for 'album' highlighting
document.addEventListener('htmx:afterOnLoad', function(evt) {
    // Remove 'active' from all tabs
    document.querySelectorAll('.album').forEach(function(tab){ tab.classList.remove('active'); });
    // Add 'active' to the triggering album-tab, if any
    if(evt.detail && evt.detail.elt){
        var trigger = evt.detail.elt.closest('.album');
        if(trigger){ trigger.classList.add('active'); }
    }
});
window.addEventListener('DOMContentLoaded', function() {
    // On load, mark the 'All' tab as active
    var allTab = document.querySelector('.album[data-all-tab]');
    if(allTab) allTab.classList.add('active');
});
</script>
</head>
<body>

<div class="gallery-header">
    <h1><i class="fas fa-images" style="margin-right:12px;filter:blur(0.1px);color:#00b894;"></i>School Gallery</h1>
    <p>Explore albums of images and videos</p>
</div>

<div class="albums">
    <!-- All tab (permanent, always first) -->
    <div class="album" data-all-tab
        tabindex="0"
        hx-get="{% url 'gallery_page' 1 %}"
        hx-target="#media-grid"
        hx-swap="innerHTML">
        <strong><i class="fas fa-th-large" style="margin-right:8px;color:#536dfe;"></i>All</strong>
    </div>
    {% for album in albums %}
    <div class="album"
        tabindex="0"
        hx-get="{% url 'album_media' album.slug %}"
        hx-target="#media-grid"
        hx-swap="innerHTML">
        <strong>{{ album.title }}</strong>
    </div>
    {% empty %}
    <p><i class="fas fa-exclamation-circle"></i> No albums available.</p>
    {% endfor %}
</div>

<!-- Gallery grid container (HTMX target) -->
<div id="media-grid" hx-get="{% url 'gallery_page' 1 %}" hx-trigger="load"></div>

</body>
</html>
